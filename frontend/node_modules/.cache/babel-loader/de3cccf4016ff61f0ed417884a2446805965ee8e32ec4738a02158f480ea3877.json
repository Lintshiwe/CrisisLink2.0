{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import LocationService from'../services/LocationService';import toast from'react-hot-toast';import{jsx as _jsx}from\"react/jsx-runtime\";const LocationContext=/*#__PURE__*/createContext();export const useLocation=()=>{const context=useContext(LocationContext);if(!context){throw new Error('useLocation must be used within a LocationProvider');}return context;};export const LocationProvider=_ref=>{let{children}=_ref;const[location,setLocation]=useState(null);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const[permissions,setPermissions]=useState('unknown');const[isTracking,setIsTracking]=useState(false);useEffect(()=>{// Check location permissions on mount\ncheckPermissions();},[]);const checkPermissions=async()=>{try{const permission=await LocationService.checkPermissions();setPermissions(permission);}catch(error){console.error('Error checking permissions:',error);}};const requestLocation=async()=>{if(isLoading)return;setIsLoading(true);setError(null);try{const position=await LocationService.getCurrentLocation();setLocation(position);setPermissions('granted');toast.success('ðŸ“ Location access granted');return position;}catch(error){setError(error.message);setPermissions('denied');toast.error(\"Location error: \".concat(error.message));throw error;}finally{setIsLoading(false);}};const startTracking=callback=>{if(isTracking)return;try{LocationService.startTracking((newLocation,error)=>{if(error){setError(error.message);toast.error(\"Tracking error: \".concat(error.message));return;}setLocation(newLocation);if(callback)callback(newLocation);});setIsTracking(true);toast.success('ðŸ“ Location tracking started');}catch(error){setError(error.message);toast.error(\"Failed to start tracking: \".concat(error.message));}};const stopTracking=()=>{if(!isTracking)return;LocationService.stopAllTracking();setIsTracking(false);toast.success('ðŸ“ Location tracking stopped');};const updateLocation=async()=>{if(isLoading)return;try{setIsLoading(true);const position=await LocationService.getCurrentLocation();setLocation(position);return position;}catch(error){setError(error.message);throw error;}finally{setIsLoading(false);}};const getDistance=(targetLat,targetLng)=>{if(!location)return null;return LocationService.calculateDistance(location.lat,location.lng,targetLat,targetLng);};const isWithinRadius=(targetLat,targetLng,radiusMeters)=>{if(!location)return false;return LocationService.isWithinRadius(targetLat,targetLng,radiusMeters,location.lat,location.lng);};const formatCoordinates=function(){let precision=arguments.length>0&&arguments[0]!==undefined?arguments[0]:6;if(!location)return null;return LocationService.formatCoordinates(location.lat,location.lng,precision);};const reverseGeocode=async()=>{if(!location)throw new Error('No location available');return LocationService.reverseGeocode(location.lat,location.lng);};const value={// State\nlocation,isLoading,error,permissions,isTracking,// Actions\nrequestLocation,startTracking,stopTracking,updateLocation,checkPermissions,// Utilities\ngetDistance,isWithinRadius,formatCoordinates,reverseGeocode,// Service access\nLocationService};return/*#__PURE__*/_jsx(LocationContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","LocationService","toast","jsx","_jsx","LocationContext","useLocation","context","Error","LocationProvider","_ref","children","location","setLocation","isLoading","setIsLoading","error","setError","permissions","setPermissions","isTracking","setIsTracking","checkPermissions","permission","console","requestLocation","position","getCurrentLocation","success","message","concat","startTracking","callback","newLocation","stopTracking","stopAllTracking","updateLocation","getDistance","targetLat","targetLng","calculateDistance","lat","lng","isWithinRadius","radiusMeters","formatCoordinates","precision","arguments","length","undefined","reverseGeocode","value","Provider"],"sources":["C:/Users/ntoam/Desktop/Projects/CrisisLink2.0/frontend/src/contexts/LocationContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport LocationService from '../services/LocationService';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst LocationContext = createContext();\r\n\r\nexport const useLocation = () => {\r\n  const context = useContext(LocationContext);\r\n  if (!context) {\r\n    throw new Error('useLocation must be used within a LocationProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const LocationProvider = ({ children }) => {\r\n  const [location, setLocation] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [permissions, setPermissions] = useState('unknown');\r\n  const [isTracking, setIsTracking] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Check location permissions on mount\r\n    checkPermissions();\r\n  }, []);\r\n\r\n  const checkPermissions = async () => {\r\n    try {\r\n      const permission = await LocationService.checkPermissions();\r\n      setPermissions(permission);\r\n    } catch (error) {\r\n      console.error('Error checking permissions:', error);\r\n    }\r\n  };\r\n\r\n  const requestLocation = async () => {\r\n    if (isLoading) return;\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const position = await LocationService.getCurrentLocation();\r\n      setLocation(position);\r\n      setPermissions('granted');\r\n      toast.success('ðŸ“ Location access granted');\r\n      return position;\r\n    } catch (error) {\r\n      setError(error.message);\r\n      setPermissions('denied');\r\n      toast.error(`Location error: ${error.message}`);\r\n      throw error;\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const startTracking = (callback) => {\r\n    if (isTracking) return;\r\n\r\n    try {\r\n      LocationService.startTracking((newLocation, error) => {\r\n        if (error) {\r\n          setError(error.message);\r\n          toast.error(`Tracking error: ${error.message}`);\r\n          return;\r\n        }\r\n\r\n        setLocation(newLocation);\r\n        if (callback) callback(newLocation);\r\n      });\r\n\r\n      setIsTracking(true);\r\n      toast.success('ðŸ“ Location tracking started');\r\n    } catch (error) {\r\n      setError(error.message);\r\n      toast.error(`Failed to start tracking: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const stopTracking = () => {\r\n    if (!isTracking) return;\r\n\r\n    LocationService.stopAllTracking();\r\n    setIsTracking(false);\r\n    toast.success('ðŸ“ Location tracking stopped');\r\n  };\r\n\r\n  const updateLocation = async () => {\r\n    if (isLoading) return;\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      const position = await LocationService.getCurrentLocation();\r\n      setLocation(position);\r\n      return position;\r\n    } catch (error) {\r\n      setError(error.message);\r\n      throw error;\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getDistance = (targetLat, targetLng) => {\r\n    if (!location) return null;\r\n    return LocationService.calculateDistance(\r\n      location.lat,\r\n      location.lng,\r\n      targetLat,\r\n      targetLng\r\n    );\r\n  };\r\n\r\n  const isWithinRadius = (targetLat, targetLng, radiusMeters) => {\r\n    if (!location) return false;\r\n    return LocationService.isWithinRadius(\r\n      targetLat,\r\n      targetLng,\r\n      radiusMeters,\r\n      location.lat,\r\n      location.lng\r\n    );\r\n  };\r\n\r\n  const formatCoordinates = (precision = 6) => {\r\n    if (!location) return null;\r\n    return LocationService.formatCoordinates(location.lat, location.lng, precision);\r\n  };\r\n\r\n  const reverseGeocode = async () => {\r\n    if (!location) throw new Error('No location available');\r\n    return LocationService.reverseGeocode(location.lat, location.lng);\r\n  };\r\n\r\n  const value = {\r\n    // State\r\n    location,\r\n    isLoading,\r\n    error,\r\n    permissions,\r\n    isTracking,\r\n    \r\n    // Actions\r\n    requestLocation,\r\n    startTracking,\r\n    stopTracking,\r\n    updateLocation,\r\n    checkPermissions,\r\n    \r\n    // Utilities\r\n    getDistance,\r\n    isWithinRadius,\r\n    formatCoordinates,\r\n    reverseGeocode,\r\n    \r\n    // Service access\r\n    LocationService\r\n  };\r\n\r\n  return (\r\n    <LocationContext.Provider value={value}>\r\n      {children}\r\n    </LocationContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}